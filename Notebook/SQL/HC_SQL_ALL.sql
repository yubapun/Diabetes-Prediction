--------------------------------------- NUMBER OF PATIENTS IN NUS FROM 2017-2021 --------------------------
SELECT COUNT(DISTINCT dp.PATIENT_IDENTIFIER) AS unique_patient
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID
WHERE dt.CDATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')

-------------------------------------  average age and sd with referene date ---------------------------------------------
SELECT AVG(age_2024) as mean_age, STDEV(age_2024) as sd_age
FROM (
	SELECT DISTINCT dp.PATIENT_IDENTIFIER, DATEDIFF(YEAR, dp.BIRTH_DATE, '2024-01-01')	
		-CASE 
		WHEN MONTH(dp.BIRTH_DATE) > 1 OR (MONTH(dp.BIRTH_DATE) = 1 AND DAY(dp.BIRTH_DATE) > 1) THEN 1 
		ELSE 0
		END AS age_2024
	FROM db.dbo.DENCOUNTER denc 
	INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
	INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
	INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID
	INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
	INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID
	INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
	INNER JOIN db.dbo.INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID
 dt ON denc.START_DT_ID = dt.DATE_ID
	WHERE dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
	AND fenc.AGE_ID > 61
	AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
	GROUP BY dp.PATIENT_IDENTIFIER, dp.BIRTH_DATE 
) AS unique_patients


---------------------------------------Gender distribution 2017-2021 ----------------------------------
SELECT COUNT(*) AS total_patients, 
SUM(CASE WHEN gender = 'Male' THEN 1 ELSE 0 END) AS men_count,
CAST(SUM(CASE WHEN gender = 'Male' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS DECIMAL(5,2)) AS men_percent
FROM(
	SELECT DISTINCT dp.PATIENT_IDENTIFIER, MAX(dg.GENDER) AS gender 
	FROM db.dbo.DENCOUNTER denc 
	INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
	INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
	INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID
	INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
	INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID
	INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
	INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
	WHERE dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
	AND fenc.AGE_ID > 61
	AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
	GROUP BY dp.PATIENT_IDENTIFIER 
) AS unique_patients


-------------------------------------------------RACE DISTRIBUTION -------------------------------------
SELECT race, COUNT(*) AS patient_count,
CAST(COUNT(*) * 100.0 / total.total_patients AS DECIMAL(5,2)) AS percen
FROM(
	SELECT DISTINCT dp.PATIENT_IDENTIFIER, MAX(dr.RACE) AS race 
	FROM db.dbo.DENCOUNTER denc 
	INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
	INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
	INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID
	INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
	INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID
	INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
	INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID
	WHERE dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
	AND fenc.AGE_ID > 61
	AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
	GROUP BY dp.PATIENT_IDENTIFIER 
) AS unique_patients
CROSS JOIN (
	SELECT COUNT(DISTINCT dp.PATIENT_IDENTIFIER) AS total_patients
	FROM db.dbo.DENCOUNTER denc 
	INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
	INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
	INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID
	INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
	INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID
	INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
	INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
	WHERE dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
	AND fenc.AGE_GROUP_ID > 61
	AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
) AS total
group by race, total.total_patients


-------------------------------------------------icd cohort -------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, fenc.ICD9, fenc.ICD9CM,
dt.DATE_DATE as ENC_DATE, sec.XML
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID
INNER JOIN cdoc_db.dbo.note_column n ON denc.CASE_ID = n.CaseID
INNER JOIN cdoc_db.dbo.section_column sec ON n.O_ID = sec.Note_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_GROUP_ID > 61 
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C64%' OR fenc.ICD9CM LIKE 'D300%')
OR (fenc.ICD9 LIKE 'C64%' OR fenc.ICD9 LIKE 'D300%'))
AND (sec.XML != '' OR sec.Text != '')
AND sec.IsLatestSectionVer LIKE '1')
ORDER BY dp.PATIENT_IDENTIFIER

----------------------------------------------- SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, fenc.ICD9, fenc.ICD9CM,
dt.DATE_DATE as ENC_DATE, sec.XML
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID
INNER JOIN cdoc_db.dbo.note_column n ON denc.CASE_ID = n.CaseID
INNER JOIN cdoc_db.dbo.section_column sec ON n.O_ID = sec.Note_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
--endometrial cancer
--AND (fct.DIAGNOSIS_CODE IN ('371973000', '1229105017', '3012523015', '403928010', '240022012', '379735014', 
--'3499291018', '3499294014', '3636679013', '207103018', '192334017', '3333071010', '3333074019', '3333068019',
--'3333065016', '3499293015', '3499295010', '3312499013', '3852376016', '3636681010', '3333083012', '2994977010',
--'510605012', '205166013'))
--Ovarian Cancer
--AND (fct.DIAGNOSIS_CODE IN ('363443007', '363444001', '9491004', '1228569014', '3035729016', '3012579018', 
--'3012586014', '3012567018', '3012633017', '1228570010', '3012577016', '3012630019', '3012583018', '3012589019', 
--'2643597016', '510637013', '3307072018', '3012796019', '3307070014', '3307071013', '510864011', '1210694017',
--'2647879018', '1210573014', '413201016', '482686019'))
--Renal Cancer
--AND (fct.DIAGNOSIS_CODE IN ('363458004', '363457009', '1228587012', '510460010', '45320010',' 215394019', '403951010',
--'240061016', '1786810016', '1228584017', '183328018', '1219788012', '3753977019', '35260666013', '3754974014', 
--'3323177015', '3323175011'))
--TNBC/BC
--AND (fct.DIAGNOSIS_CODE IN ('372096000', '372095001', '254837009', '706970001', '3027973018', '3028040013', 
--'1210674014', '153101013', '153242015', '153263018', '2160190012', '2164000010', '2164001014', '2164002019',
--'24003015', '2643562018', '2643563011', '2643564017', '2674178014', '2770060010', '2772522016', '2871040011',
--'2871097013', '2871914019', '2871985014', '2872218012', '2872712012', '2872713019', '2872714013', '2872933014', 
--'2899466013', '290870018', '3008875015', '3009609015', '3027973018', '3028040013', '3036010011', '3036344014', 
--'3290542017', '3331795012', '3331797016', '3331846019', '3331912016', '3332121018', '3332122013', '3620957016',
--'3642597012', '3671350015', '3671353018', '3756408015', '3756409011', '3756412014', '3756413016', '3756416012', 
--'3756417015', '379662011', '379663018', '379665013', '379667017', '379668010', '3873457010', '3873459013', '3956094016',
--'414829016', '426376018', '426377010', '426378017', '426380011', '426381010'))
--Ovarian Leio
--AND fct.DIAGNOSIS_CODE IN ('1217418010', '1218678011', '429877019', '192332018')
--stomach cancerin situ
--AND fct.DIAGNOSIS_CODE IN ('92756002', '3038125016', '3036558010', '3037930015', '153367015')
-- DIFFUSE GASTRIC CANCER
--AND fct.DIAGNOSIS_CODE IN ('721629005', '716859000', '363349007', '63369016', '450902017', '3325637014', '3307808019', 
--'3307809010', '122845018', '1228483013', '27772105011', '288632016', '1228484019', '511086019', '380125012', '1229145014', 
--'380124011', '3306822012', '1228484019', '511086019', '380125012', '1228483013', '511088018', '380126013', '3040651019', '1288485018', 
--'63369016', '450902017', '3325637014', '3307808019', '3307809010', '1210719018', '380127016', '239904017', '2160194015', '3663552019', 
--'3662514010', '1210596014', '511083010')
--RENAL_MMR
AND fct.DIAGNOSIS_CODE IN ('41607009', '363518003', '1228636016', '69405015', '2995609017', '69406019', '1229779019', '207086013', '207085012', '207084011',
'3310136019', '3310136019', '3310132017', '3499674012', '3499671016', '3482073016', '2995513016', '3896367015', '3499505018', '3499664014', '3499667019',
'3481843012', '3481835019', '3303028017', '3655784011', '3310136019', '3655326012', '379798014', '207084011', '379811010', '3317341015', '3317343017', 
'207083017', '3499505018', '207084011')
AND (sec.XML != '' OR sec.Text != '')
AND sec.LatestSectionVer LIKE '1')
ORDER BY dp.PATIENT_IDENTIFIER

----------------------------------------- Colorectal Cancer ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, fenc.ICD9, fenc.ICD9CM,
dt.DATE_DATE as ENC_DATE, sec.XML
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_GROUP_ID > 61 
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C19%' OR fenc.ICD9CM LIKE 'C20%' OR fenc.ICD9CM LIKE 'C18%')
OR (fenc.ICD9 LIKE 'C19%' OR fenc.ICD9 LIKE 'C20%' OR fenc.ICD9 LIKE 'C18%')))



------------------------------------------- Colorectal Cancer SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('363406005', '1286877004', '3746849018', '1228486017', '239932014', '3288335015', '3288737014', '3288993017',
'3288598016', '3288712016', '3289030012', '3288530014', '1228536014', '3290094014', '1217954019', '1217953013', '3035992013', '3036828014', 
'3037442018', '2535205018', '380130011', '2535206017', '2900489012', '2160192016', '1217953013', '1228535013', '1216462014', '1228624010', 
'1228487014', '403809019', '239912013', '2643505019', '2643506018', '2643508017', '2643507010', '2915311014', '3790880010', '403832015', 
'239933016', '288678012', '379090011', '2643851011', '510572019', '510954015')))



----------------------------------------- Endometrial Cancer ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C55%' OR fenc.ICD9CM LIKE 'C54%')
OR (fenc.ICD9 LIKE 'C55%' OR fenc.ICD9 LIKE 'C54%')))


------------------------------------------- ENDOMETRIAL Cancer SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('371973000', '1229105017', '3012523015', '403928010', '240022012', '379735014', '3499291018', '3499294014', 
'3636679013', '207103018', '192334017', '3333071010', '3333074019', '3333068019', '3333065016', '3499293015', '3499295010', '3312499013',
'3852376016', '3636681010', '3333083012', '2994977010', '510605012', '205166013')))



----------------------------------------- Ovarian Cancer ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C56%' OR fenc.ICD9CM LIKE 'C57%' OR fenc.ICD9CM LIKE 'C48%')
OR (fenc.ICD9 LIKE 'C56%' OR fenc.ICD9 LIKE 'C57%' OR fenc.ICD9 LIKE 'C48%')))


------------------------------------------- Ovarian Cancer SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('363443007', '363444001', '94091004', '1228569014', '3035729016', '3012579018', '3012586014', '3012567018', 
'3012633017', '1228570010', '3012577016', '3012630019', '3012583018', '3012589019', '2643597016', '510637013', '3307072018', '3012796019', 
'3307070014', '3307071013', '510864011', '1210694017', '2647879018', '1210573014', '413201016', '482686019')))



----------------------------------------- CRC, Desmoid Tumor ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'D48119%')
OR (fenc.ICD9 LIKE 'D48119%')))

------------------------------------------- CRC, Desmoid Tumor SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('725049005', '47284001', '3009687015', '3437476014', '3009692018', '3437477017', '1783743017', '1784129011', '3437476014')))


----------------------------------------- Pancreatic Cancer ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C25%')
OR (fenc.ICD9 LIKE 'C25%')))

------------------------------------------- Pancreatic Cancer SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('363418001', '255088001', '1228546011', '510885011', '2990560014', '3800437019', '3760303017', '1228545010', 
'510886012', '288723014', '3800446013', '510890014', '1228547019', '151015', '510884010')))


----------------------------------------- Renal Cancer ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C64%')
OR (fenc.ICD9 LIKE 'C64%')))

------------------------------------------- RENAL Cancer SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('41607009', '363518003', '1228636016', '69405015', '2995609017', '69406019', '1229779019', '207086013', '207085012', '207084011',
'3310136019', '3310136019', '3310132017', '3499674012', '3499671016', '3482073016', '2995513016', '3896367015', '3499505018', '3499664014', '3499667019',
'3481843012', '3481835019', '3303028017', '3655784011', '3310136019', '3655326012', '379798014', '207084011', '379811010', '3317341015', '3317343017', 
'207083017', '3499505018', '207084011')))

----------------------------------------- Prostate Cancer ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C61%')
OR (fenc.ICD9 LIKE 'C61%')))

------------------------------------------- Prostate Cancer SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('399068003', '3036967016', '379768019', '3330702010', '3330700019', '1786665019', 
'1228573012', '1786664015', '1228572019', '1778899017', '379767012', '1778899017', '3866718011', '3866442014', 
'3866720014')))


----------------------------------------- Kidney Cancer ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C64%')
OR (fenc.ICD9 LIKE 'C64%')))

------------------------------------------- Kidney Cancer SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('363518003', '1228636016', '69405015', '2995609017', '69406019', '1229779019', '207086013', '207085012', '207084011',
'3310136019', '3310136019', '3310132017', '3499674012', '3499671016', '3482073016', '2995513016', '3896367015', '3499505018', '3499664014', '3499667019',
'3481843012', '3481835019', '3303028017', '3655784011', '3310136019', '3655326012', '379798014', '207084011', '379811010', '3317341015', '3317343017', 
'207083017', '3499505018', '207084011')))



------------------------------------------- cutaneous leiomyoma SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('254767008', '1162799008', '379479011')))

----------------------------------------- Paraganglioma or phaeochromocytoma ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C741%')
OR (fenc.ICD9 LIKE 'C741%')))

------------------------------------- Paraganglioma or phaeochromocytoma SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('115222007', '302835009', '444769017', '2405017', '202325013', '17285013', '1217357018', 
'1215857014', '175978016', '175978016', '3331747015', '444774013', '141864017', '476000018', '370876019', '3498487019',
'49140019')))

------------------------------------- HAEMANGIOBLASTOMA SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('81201000', '1156474009', '506440012', '4749015', '122995019', '140972012')))


--------------------------------------- PANCREATIC NEUROENDOCRINE TUMOR ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C254%')
OR (fenc.ICD9 LIKE 'C254%')))

------------------------------------- Pancreatic neuroendocrine tumor SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('717919005', '3326473015', '3323124013', '3310596011', '3515311012', '356069017', '356070016', '3008903010')))


-------------------------------------- colorectal polyps ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'K635%')
OR (fenc.ICD9 LIKE 'K635%')))

----------------------------------- COLORECTAL POLYP SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('53633000', '1149090009', '110448004', '82375006', '113768012', '3866635016', 
'413597010', '90442013', '245132018', '1231335010', '89164019', '175283019', '16287010', '16289013', 
'510085010', '136639015', '502281012', '2695183015', '117806017', '502282017')))


-------------------------------------- Thyroid ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C73%')
OR (fenc.ICD9 LIKE 'C73%')))

----------------------------------- THYROID SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('380006011', '1228592014', '2643596013', '3720066018', '3720063013', '380009016', '380008012', '3720065019', '3039135019', '3037882019', '3321435018', '380010014', '332146017', '3310128011')))

-------------------------------------- CARNEY ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'D151%' OR fenc.ICD9CM LIKE 'E22%')
OR (fenc.ICD9 LIKE 'D152%' OR fenc.ICD9 LIKE 'E22%')))

----------------------------------- CARNEY SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('57373003', '74107003', '985004', '733491005', '63166000')))

-------------------------------------- Diffuse Gastric ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C16%')
OR (fenc.ICD9 LIKE 'C16%')))

----------------------------------- Diffuse Gastric SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('721629005', '716859000', '63369016', '450902017', '3325637014', '3307808019', '3307809010', '1228485018', '1228483013', 
'2772105011', '288632016', '1228484019', '511086019', '380125012', '1229145014', '380124011', '3306822012', '1228484019', '511086019', '380125012', 
'1228483013', '511088018', '380126013', '3040651019', '1288485018', '63369016', '450902017', '3325637014', '307808019', '3307809010', '1210719018',
'380127016', '239904017', '2160194015', '239904017', '2160194015', '3663552019', '3662514010', '1210596014', '511083010')))


----------------------------------- Lobular BC SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('278054005', '414829016', '174576019', '290871019', '3755407019', '3755406011')))


-------------------------------------- Intestinal Polyp ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'K635%' OR fenc.ICD9CM LIKE 'K621%')
OR (fenc.ICD9 LIKE 'K635%' OR fenc.ICD9 LIKE 'K621%')))

----------------------------------- Intestinal Polyp SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('254588001', '254589009', '175283019', '16287010', '16289013', '510085010', '3866635016', '413597010', '90442013', '245132018', '1231335010', '89164019', '136639015', '502281012', '2695183015', '117806017', '502282017')))



-------------------------------------- Melanoma ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C43%')
OR (fenc.ICD9 LIKE 'C43%')))

----------------------------------- Melanoma SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('1162635006', '28733011', '4604012', '129428017', '291611016', '403891012', '239986018', '173827014', '173845014', '173821010', '290853014', '459719019', '290862011', '173831015',
 '45950014', '3353843013', '290852016', '173825018', '459499017', '290860015', '173833017', '290857010', '3029784012', '3029854013', '173841017',' 2773592018', '173843019', '178339018', '3333089011', '459501013',
 '290861016', '202773018', '173837016', '290856018', '173835012', '202772011', '3648625014', '3649435016', '207323016', '3310727012', '173829012', '173823013', '290854015', '290858017', '290859013', '290855019', 
 '3526664010', '4601016', '1210820017', '403890013', '239985019', '403754010', '291598018', '1235800012', '1781677011', '2986774013', '2672981016', '1782926016', '1782926016', '1782928015', '413033017', '1781674016', 
 '1781676019', '126126010', '379409012', '1781675015', '200557018', '379415012', '379416013', '379414011', '503155012', '291593010', '379410019', '4703012', '291594016', '2838285019', '379762018', '291605019', '84190018', '35572018', '292116013', 
 '91969014', 
 '1778982017', 
 '1779022014', 
 '379411015', 
 '289024019', 
 '27148012')))

-------------------------------------- Astrocytoma ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C71%')
OR (fenc.ICD9 LIKE 'C71%')))

----------------------------------- Astrocytoma SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('1157043006', '291826017', '64413017', '379848018', '380002013', '197379011', '3288925015', '92027010', '3287659016', '2770343012', '2972943011')))


------------------------------------- Gastric ICD ------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C16%')
OR (fenc.ICD9 LIKE 'C16%')))

----------------------------------- Gastric Cancer SNOMED ---------------------------------------------------

SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dg.GENDER, dr.RACE, denc.ENCOUNTER_KEY, denc.CASE_ID, 
fct.DIAGNOSIS_CODE, fenc.ICD9, fenc.ICD9CM, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND (fct.DIAGNOSIS_CODE IN ('363349007', '721629005', '716859000', '1228484019', '511086019', '380125012', '1229145014', '380124011', '3306822012', '1228484019', '511086019', '380125012', '380125012', '1228483013', '511088018', '380126013', '3040651019', '1288485018', '63369016', '450902017', '3325637014', '3307808019', '3307809010', '1210719018', '380127016', '239904017', '2160194015', '239904017', '2160194015', '3663552019', '3662514010', '1210596014', '511083010', '1228485018', '1228483013', '2772105011', '288632016')))


------------------------------------------- FREE TEXT EXTRACTION ----------------------------------------------
------------------------------------------- ICD ---------------------------------------------
SELECT DISTINCT dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
sec.XML, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.FENCOUNTER fenc ON denc.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
INNER JOIN cdoc_2012_2022.dbo.notes n ON denc.CASE_ID = n.CaseNo_NoCheckDigit_SHA1 
INNER JOIN cdoc_2012_2022.dbo.sections sec ON n.OID = sec.NotesOID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND ((fenc.ICD9CM LIKE 'C16%')
OR (fenc.ICD9 LIKE 'C16%'))
AND (sec.XML != '' OR sec.Text != ''))

---------------------------------------------------------- SNOMED -----------------------------------
SELECT DISTINCT  dp.PATIENT_IDENTIFIER, ag.AGE, dr.RACE, dg.GENDER, denc.ENCOUNTER_KEY, denc.CASE_ID, 
sec.XML, dt.DATE_DATE as ENC_DATE
FROM db.dbo.DENCOUNTER denc 
INNER JOIN db.dbo.DPATIENT dp ON denc.PATIENT_IDENTIFIER = dp.PATIENT_IDENTIFIER 
INNER JOIN db.dbo.F_CLIN_DIAGNOSIS fct ON denc.ENCOUNTER_KEY = fct.ENCOUNTER_KEY 
INNER JOIN db.dbo.FENCOUNTER fenc ON fct.ENCOUNTER_KEY = fenc.ENCOUNTER_KEY 
INNER JOIN db.dbo.AGE_DETAIL ag ON fenc.AGE_ID = ag.AGE_ID 
INNER JOIN db.dbo.GENDER dg ON dp.GENDER_ID = dg.GENDER_ID 
INNER JOIN db.dbo.RACE dr ON dp.RACE_ID = dr.RACE_ID 
INNER JOIN db.dbo.DOCUMENT doc ON dp.DOCUMENT_TYPE_ID = doc.DOCUMENT_TYPE_ID 
INNER JOIN db.dbo.DATE_DATE dt ON denc.START_DT_ID = dt.DATE_ID 
INNER JOIN cdoc_2012_2022.dbo.notes n ON denc.CASE_ID = n.CaseNo_NoCheckDigit_SHA1 
INNER JOIN cdoc_2012_2022.dbo.sections sec ON n.OID = sec.NotesOID 
WHERE (dt.DATE_DATE BETWEEN '2017-01-01' AND '2021-12-31'
AND fenc.AGE_ID > 61
AND doc.DOCUMENT_TYPE_ID IN ('1', '16')
AND fct.DIAGNOSIS_CODE IN ('363349007', '721629005', '716859000', '1228484019', '511086019', '380125012', 
'1229145014', '380124011', '3306822012', '1228484019', '511086019', '380125012', '380125012', '1228483013',
'511088018', '380126013', '3040651019', '1288485018', '63369016', '450902017', '3325637014', '3307808019', 
'3307809010', '1210719018', '380127016', '239904017', '2160194015', '239904017', '2160194015', '3663552019',
'3662514010', '1210596014', '511083010', '1228485018', '1228483013', '2772105011', '288632016')
AND (sec.XML != '' OR sec.Text != ''))